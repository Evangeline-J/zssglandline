<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:300,400,700" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: white;
            font-family: 'Alibaba PuHuiTi', sans-serif;
            overflow-x: hidden;
            overflow-y: hidden;
            width: 100vw;
            height: 100vh;
        }

        .back-home-container {
            position: fixed;
            top: 5%;
            right: 4%;
            width: 16%;
            z-index: 100;
        }
        
        .back-home {
            padding: 2% 4%;
            background-color: rgba(58, 58, 58, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 30px;
            color: white;
            text-decoration: none;
            font-size: 1.2vw;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .back-zh {
            font-size: 1.6vw;
            font-weight: 400;
            display: block;
            margin-bottom: 2px;
            letter-spacing: 0.2vw;
        }
        
        .back-en {
            font-size: 1.2vw;
            font-weight: 400;
            display: block;
            letter-spacing: 0.2vw;
        }
        
        .back-previous {
            position: fixed;
            top: 14vh;
            left: 4%;
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            font-size: 1.6vw;
            z-index: 100;
            font-weight: 500;
        }
        
        .back-previous:before {
            content: '<';
            margin-right: 5px;
            font-size: 1.8vw;
        }
        
        .video-container {
            position: fixed;
            top: 15vh;
            /* 修改定位，使其水平居中 */
            left: 50%;
            transform: translateX(-50%);
            /* 宽度将由JS动态设置，不再是固定的100% */
            width: auto;
            max-width: 100%;
            height: 45vh;
            z-index: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
        }
        
        video {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        .content-container {
            position: absolute;
            top: 62vh;
            /* 水平居中 */
            left: 50%;
            transform: translateX(-50%);
            /* 宽度将由JS动态设置 */
            width: auto;
            max-width: 100%;
            min-height: 35vh;
            /* 移除滚动相关属性 */
            overflow: visible;
            background-color: #000;
            padding: 0;
            box-sizing: border-box;
            z-index: 2;
        }
        
        .content-description {
            font-size: 16px;
            line-height: 1.6;
            /* 移除固定的margin-bottom */
            /* 添加滚动相关属性 */
            /* 高度将由JS动态计算 */
            overflow-y: auto;
            overflow-x: hidden;
            padding-right: 10px; /* 为滚动条留出空间 */
            margin-bottom: 15vh; /* 为scroll-indicator留出足够空间 */
        }
        
        /* 自定义滚动条样式 */
        .content-description::-webkit-scrollbar {
            width: 8px;
        }

        .content-description::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 4px;
        }

        .content-description::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
        }

        .content-description::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }
        
        .scroll-indicator {
            position: fixed;
            bottom: 0.5vh;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            /* 移除弹跳动画 */
            z-index: 10;
        }
        
        .scroll-indicator-text {
            font-size: 2vw;
            margin-bottom: 5px;
        }
        
        .scroll-indicator-arrow {
            width: 5vw; /* 根据实际图片尺寸调整 */
            height: auto;
            margin-bottom: 5px;
        }
        
        /* 移除不再使用的动画定义 */
    </style>
</head>
<body>
    <div class="back-home-container">
        <a href="../index.html" class="back-home">
            <span class="back-zh">返回首页</span>
            <span class="back-en">BACK TO HOME</span>
        </a>
    </div>

    <a href="./result.html" class="back-previous">返回上一页</a>   
    
    <div class="video-container">
        <video id="main-video" autoplay muted loop playsinline></video>
    </div>
    
    <div class="content-container">
        <div class="content-description">
            <p>盘锦湿地保护协会是旨在宣传和保护辽河入海口湿地生态环境和生物多样性的环保NGO。2019年注册，主管单位为盘锦市林业和湿地保护管理局，前身是2007年创立的盘锦保护斑海豹志愿者协会，2020年被评为4A级社团。</p>
            
            <p>协会长期致力于湿地生态系统的保护和修复工作，组织开展了多项湿地保护活动，包括湿地监测、生物多样性调查、环境教育和公众参与等。</p>
            
            <p>通过与政府部门、科研机构和其他社会组织的合作，协会在湿地保护领域取得了显著成果，为维护辽河入海口湿地生态系统的健康和稳定做出了重要贡献。</p>
            
            <p>盘锦湿地是中国最大的芦苇湿地，也是世界上最完整的湿地生态系统之一。这里栖息着众多珍稀鸟类和水生动物，是东北亚候鸟迁徙的重要中转站和栖息地。</p>
            
            <p>协会的主要工作包括：</p>
            <ul>
                <li>湿地生态系统监测与研究</li>
                <li>濒危物种保护与栖息地修复</li>
                <li>环境教育与公众意识提升</li>
                <li>可持续发展模式探索与推广</li>
                <li>国际合作与经验交流</li>
            </ul>
            
            <p>近年来，协会积极参与国际湿地保护网络，与多个国际组织建立了长期合作关系，共同推动全球湿地保护事业的发展。</p>
            
            <p>协会定期举办"湿地保护日"、"观鸟节"等公众活动，通过科普讲座、实地考察、志愿服务等形式，提高公众对湿地保护的认识和参与度。</p>
        </div>
    </div>
    
    <div class="scroll-indicator">
        <img src="../img/scroll-indicator.png" class="scroll-indicator-arrow" alt="向下滚动">
        <div class="scroll-indicator-text">下滑阅读更多</div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 从localStorage获取选中的视频
            const selectedVideo = localStorage.getItem('selectedVideo');
            
            // 设置视频源
            const videoElement = document.getElementById('main-video');
            if (selectedVideo) {
                videoElement.src = selectedVideo;
            } else {
                // 如果没有选中的视频，使用默认视频
                videoElement.src = '../video/System03_Extraction_Hauling.mp4';
            }
            
            // 视频加载错误处理
            videoElement.addEventListener('error', function() {
                console.error('视频加载失败');
                // 使用备用视频
                videoElement.src = '../video/System03_Extraction_Hauling.mp4';
            });
            
            // 记录事件（如果GA可用）
            if (typeof ga === 'function') {
                ga('send', 'event', 'Video', 'view_detail');
            }
            
            // 获取视频容器和内容容器
            const videoContainer = document.querySelector('.video-container');
            const contentContainer = document.querySelector('.content-container');
            
            // 函数：根据视频实际宽度调整容器宽度
            function adjustContainersWidth() {
                // 获取视频的原始尺寸（视频的固有宽度和高度）
                const videoWidth = videoElement.videoWidth;
                const videoHeight = videoElement.videoHeight;
                
                if (videoWidth && videoHeight) {
                    // 计算视频在容器中的实际显示宽度
                    // 基于视频容器的高度和视频的宽高比
                    const containerHeight = videoContainer.clientHeight;
                    const aspectRatio = videoWidth / videoHeight;
                    const displayWidth = containerHeight * aspectRatio;
                    
                    // 设置视频容器宽度
                    videoContainer.style.width = displayWidth + 'px';
                    
                    // 设置内容容器宽度与视频容器一致
                    contentContainer.style.width = displayWidth + 'px';
                    
                    console.log('视频原始尺寸:', videoWidth, 'x', videoHeight);
                    console.log('视频显示宽度:', displayWidth);
                    console.log('容器宽度:', videoContainer.style.width);
                } else {
                    console.log('视频尺寸尚未可用');
                    // 如果视频尺寸尚未可用，稍后再试
                    setTimeout(adjustContainersWidth, 100);
                }
            }
            
            // 视频元数据加载完成后调整宽度
            videoElement.addEventListener('loadedmetadata', function() {
                // 延迟一点执行，确保视频已经渲染
                setTimeout(adjustContainersWidth, 100);
            });
            
            // 视频大小变化时调整宽度
            videoElement.addEventListener('resize', adjustContainersWidth);
            
            // 窗口大小改变时重新调整
            window.addEventListener('resize', adjustContainersWidth);
            
            // 初始调整（可能视频已经加载）
            if (videoElement.readyState >= 1) {
                setTimeout(adjustContainersWidth, 100);
            }
            
            // 获取content-description和scroll-indicator元素
            const contentDescription = document.querySelector('.content-description');
            const scrollIndicator = document.querySelector('.scroll-indicator');
            
            // 计算并设置content-description的高度
            function adjustContentHeight() {
                // 获取视频容器的底部位置
                const videoBottom = videoContainer.getBoundingClientRect().bottom;
                
                // 获取scroll-indicator的高度
                const scrollIndicatorHeight = scrollIndicator.offsetHeight;
                
                // 计算content-description可用的高度
                // 窗口高度 - 视频底部位置 - scroll-indicator高度 - 额外边距
                const availableHeight = window.innerHeight - videoBottom - scrollIndicatorHeight - 20;
                
                // 设置content-description的高度
                contentDescription.style.maxHeight = availableHeight + 'px';
                
                console.log('content-description高度:', availableHeight);
            }
            
            // 在窗口大小改变时重新计算高度
            window.addEventListener('resize', adjustContentHeight);
            
            // 初始计算高度
            setTimeout(adjustContentHeight, 200);

            // 监听content-description的滚动事件
            contentDescription.addEventListener('scroll', function() {
                // 计算滚动位置
                const scrollTop = contentDescription.scrollTop;
                const scrollHeight = contentDescription.scrollHeight;
                const clientHeight = contentDescription.clientHeight;
                
                // 如果已经滚动到底部或接近底部，隐藏scroll-indicator
                if (scrollTop + clientHeight >= scrollHeight - 20) {
                    scrollIndicator.style.opacity = '0';
                    scrollIndicator.style.transition = 'opacity 0.3s ease';
                } else {
                    scrollIndicator.style.opacity = '1';
                    scrollIndicator.style.transition = 'opacity 0.3s ease';
                }
            });
        });
    </script>
</body>
</html>
